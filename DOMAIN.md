# Единый Язык (Ubiquitous Language) Проекта

Этот документ определяет ключевые термины, концепции и границы контекстов предметной области (домена) приложения для тренировки слепой печати.

---

## 1. Основные доменные понятия

### 1.1. Клавиатура и физическое устройство

- **Клавиатура (Keyboard):** Физическое устройство ввода. В приложении представлено его визуальной и логической моделью.
  - **Реализация:** `src/components/ui/keyboard.tsx`

- **Физическая раскладка (Physical Layout):** Схема расположения, формы и размера клавиш (например, ANSI, ISO).
  - **Реализация:** `src/data/physical-keyboard-ansi.ts`, тип `PhysicalKeyboard`.

- **Клавиша (KeyCap):** Физическая или виртуальная клавиша.
  - **Реализация:** `src/components/ui/keycap.tsx`.

- **Код клавиши (Key Event Code / `keyCapId`):** Уникальный идентификатор клавиши, соответствующий `KeyboardEvent.code` (например, `KeyA`, `ShiftLeft`). В более универсальном смысле может рассматриваться как **HID-код**.
  - **Реализация:** `src/interfaces/key-events-codes.ts`.

### 1.2. Раскладки и символы

- **Символьная раскладка (Symbol Layout):** Логическая схема распределения символов по физическим клавишам (например, QWERTY, Dvorak).
  - **Реализация:** `src/data/symbol-layout.ts`, тип `SymbolLayout`.

- **Легенда клавиши (Key Legend):** Символы, нанесенные на клавишу.
  - **`base`:** Основной символ (нижний регистр).
  - **`shift`:** Символ, вводимый с `Shift`.
  - **`altGr`:** Символ, вводимый с `AltGr` (на некоторых раскладках).
  - **Реализация:** (Пока не детализировано в типах, но является частью `symbol-layout.ts`).

### 1.3. Руки и пальцы

- **Рука (Hand):** Левая (`LeftHand`) или правая (`RightHand`).
  - **Реализация:** Тип `Hands` в `src/interfaces/types.ts`.

- **Палец (Finger):** Палец с уникальным кодом (L4-L0, R0-R4).
  - **Реализация:** Тип `Fingers` в `src/interfaces/types.ts`.

- **Зона пальцев (Finger Zoning):** Схема ответственности каждого пальца за определенные клавиши.
  - **Реализация:** `src/data/fingers-zones-asdf.ts`, тип `FingerZones`.

### 1.4. Система обучения

- **Домашний ряд (Home Row Keys):** Ряд клавиш, на котором пальцы располагаются в исходной позиции (ASDF JKL;).
- **Якорные клавиши (Anchor Keys):** Клавиши F и J, имеющие тактильные маркеры для ориентации вслепую.
- **Функциональная группа (Functional Group):** Группы клавиш по назначению (модификаторы, навигационные, символьные).

---

## 2. Состояния и визуальное представление

Ключевые состояния, определяющие внешний вид и поведение клавиши в интерфейсе.

- **`visibility` (Видимость):** `HIDDEN` (скрыта) / `VISIBLE` (видима).
- **`navigationRole` (Навигационная роль):**
  - `HOME`: Исходная позиция (якорная клавиша).
  - `TARGET`: Текущая цель для нажатия.
  - `PATH`: Клавиша на пути к цели.
  - `IDLE`: Не участвует в навигации.
- **`pressResult` (Результат нажатия):**
  - `NEUTRAL`: Не оценено.
  - `CORRECT`: Правильное нажатие.
  - `INCORRECT`: Ошибочное нажатие.
- **`homeKeyMarker` (Маркер домашнего ряда):**
  - `BAR`: Черточка (F/J).
  - `DOT`: Точка.
  - `NONE`: Без маркера.

**Реализация:** Все эти состояния определены как типы в `src/interfaces/types.ts`.

---

## 3. Контекстные границы (Bounded Contexts)

Стратегическое разделение домена на независимые части.

### 3.1. Контекст "Конфигуратор Клавиатуры" (Keyboard Setup Context)
- **Ответственность:** Все, что связано с физическим и логическим устройством клавиатуры.
- **Понятия:** `PhysicalLayout`, `SymbolLayout`, `KeyCap`, `FingerZoning`.

### 3.2. Контекст "Обучение" (Training Context)
- **Ответственность:** Процесс тренировки, упражнения и оценка прогресса.
- **Понятия:** `Lesson`, `Exercise`, `TrainingSession`, `Speed`, `Accuracy`.

### 3.3. Контекст "Визуализация" (Visualization Context)
- **Ответственность:** Отображение клавиатуры, рук, пальцев и обратной связи.
- **Понятия:** `KeyCap States`, `Hand Positioning`, `Animations`, `Color Themes`.

---

## 4. Доменные сервисы (Domain Services)

Операции в домене, которые не принадлежат конкретной сущности. (Определены как цель для будущей реализации).

- **`TextGeneratorService`:** Генерирует тексты для упражнений.
- **`FingerPathCalculator`:** Рассчитывает оптимальные траектории движения пальцев.
- **`ErrorAnalyzer`:** Анализирует ошибки и дает рекомендации.

---

## 5. Доменные события (Domain Events)

События, сообщающие о значимых изменениях в домене. (Определены как цель для будущей реализации).

- **`KeyPressEvaluated`:** Нажатие клавиши было оценено (правильно/неправильно).
- **`LessonProgressUpdated`:** Прогресс урока обновлен.
- **`HandPositionCorrected`:** Позиция руки скорректирована.

---

## 6. Важные инварианты (Invariants)

Бизнес-правила, которые всегда должны соблюдаться.

- Каждая `KeyCap` имеет уникальный `keyCapId` в рамках `PhysicalLayout`.
- Якорные клавиши (F/J) всегда имеют тактильные маркеры (`homeKeyMarker: 'BAR'`).
- Каждое состояние клавиши имеет четкий визуальный сигнал.